/* Generated by Nim Compiler v0.11.2 */
/*   (c) 2015 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: Windows, amd64, gcc */
/* Command for C compiler:
   C:\Nim\dist\mingw\bin\gcc.exe -c  -w  -IC:\Nim\lib -o c:\users\owner\documents\nim\esfj\nimcache\random_common.o c:\users\owner\documents\nim\esfj\nimcache\random_common.c */
#define NIM_INTBITS 64
#include "nimbase.h"

#include <math.h>
typedef struct Mtstate273035 Mtstate273035;
typedef NU32 TY273036[624];
struct  Mtstate273035  {
TY273036 mt;
NI mti;
};
static N_INLINE(NU32, randomuint32_275012)(Mtstate273035* self);
N_NIMCALL(NU32, genrandint32_273324)(Mtstate273035* s);
static N_INLINE(void, nimFrame)(TFrame* s);
N_NOINLINE(void, stackoverflow_20001)(void);
static N_INLINE(void, popFrame)(void);
static N_INLINE(NI, divceil_278803)(NI a, NI b);
static N_INLINE(NI, subInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(NI, addInt)(NI a, NI b);
static N_INLINE(NI, divInt)(NI a, NI b);
N_NOINLINE(void, raiseDivByZero)(void);
N_NIMCALL(NI, bitsize_270518)(NU64 x);
static N_INLINE(NU64, randomint_279766)(Mtstate273035* rng);
N_NIMCALL(NU64, randomintimpl_279777)(Mtstate273035* rng);
static N_INLINE(NI, chckRange)(NI i, NI a, NI b);
N_NOINLINE(void, raiseRangeError)(NI64 val);
extern TFrame* frameptr_17042;

static N_INLINE(void, nimFrame)(TFrame* s) {
	NI LOC1;
	LOC1 = 0;
	{
		if (!(frameptr_17042 == NIM_NIL)) goto LA4;
		LOC1 = ((NI) 0);
	}
	goto LA2;
	LA4: ;
	{
		LOC1 = ((NI) ((NI16)((*frameptr_17042).calldepth + ((NI16) 1))));
	}
	LA2: ;
	(*s).calldepth = ((NI16) (LOC1));
	(*s).prev = frameptr_17042;
	frameptr_17042 = s;
	{
		if (!((*s).calldepth == ((NI16) 2000))) goto LA9;
		stackoverflow_20001();
	}
	LA9: ;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_17042 = (*frameptr_17042).prev;
}

static N_INLINE(NU32, randomuint32_275012)(Mtstate273035* self) {
	NU32 result;
	nimfr("randomUint32", "mersenne.nim")
	result = 0;
	nimln(38, "mersenne.nim");
	result = genrandint32_273324(self);
	popFrame();
	return result;
}

N_NIMCALL(NU8, randomintimpl_277304)(Mtstate273035* rng) {
	NU8 result;
	NU32 LOC1;
	nimfr("randomIntImpl", "common.nim")
	result = 0;
	nimln(60, "common.nim");
	nimln(61, "common.nim");
	LOC1 = 0;
	LOC1 = randomuint32_275012(rng);
	result = ((NU8) (LOC1));
	popFrame();
	return result;
}

static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
{	result = 0;
	result = (NI)((NU64)(a) - (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (((NI) 0) <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (((NI) 0) <= (NI)(result ^ (NI)((NU64) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	}BeforeRet: ;
	return result;
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
{	result = 0;
	result = (NI)((NU64)(a) + (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (((NI) 0) <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (((NI) 0) <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	}BeforeRet: ;
	return result;
}

static N_INLINE(NI, divInt)(NI a, NI b) {
	NI result;
{	result = 0;
	{
		if (!(b == ((NI) 0))) goto LA3;
		raiseDivByZero();
	}
	LA3: ;
	{
		NIM_BOOL LOC7;
		LOC7 = 0;
		LOC7 = (a == ((NI) (IL64(-9223372036854775807) - IL64(1))));
		if (!(LOC7)) goto LA8;
		LOC7 = (b == ((NI) -1));
		LA8: ;
		if (!LOC7) goto LA9;
		raiseOverflow();
	}
	LA9: ;
	result = (NI)(a / b);
	goto BeforeRet;
	}BeforeRet: ;
	return result;
}

static N_INLINE(NI, divceil_278803)(NI a, NI b) {
	NI result;
	NI TMP2726;
	NI TMP2727;
	NI TMP2728;
	nimfr("divCeil", "util.nim")
	result = 0;
	nimln(28, "util.nim");
	nimln(29, "util.nim");
	TMP2726 = subInt(a, ((NI) 1));
	TMP2727 = addInt((NI)(TMP2726), b);
	TMP2728 = divInt((NI)(TMP2727), b);
	result = (NI)(TMP2728);
	popFrame();
	return result;
}

N_NIMCALL(NU, randomintimpl_277871)(Mtstate273035* rng, NU max) {
	NU result;
	NU limit;
	nimfr("randomIntImpl", "common.nim")
	result = 0;
	nimln(82, "common.nim");
	limit = (NU)((NU64)(((NU) (IL64(-9223372036854775807) - IL64(1)))) - (NU64)((NU)((NU64)(((NU) (IL64(-9223372036854775807) - IL64(1)))) % (NU64)(max))));
	nimln(85, "common.nim");
	{
		if (!((NU64)(max) <= (NU64)(((NU) IL64(4294967295))))) goto LA3;
		{
			nimln(86, "common.nim");
			while (1) {
				NU32 LOC7;
				nimln(87, "common.nim");
				LOC7 = 0;
				LOC7 = randomuint32_275012(rng);
				result = ((NU) (LOC7));
				nimln(88, "common.nim");
				{
					if (!((NU64)(result) < (NU64)(limit))) goto LA10;
					goto LA5;
				}
				LA10: ;
			}
		} LA5: ;
	}
	goto LA1;
	LA3: ;
	{
		NI neededparts;
		NI LOC13;
		nimln(90, "common.nim");
		LOC13 = 0;
		LOC13 = bitsize_270518(((NU64) (max)));
		neededparts = divceil_278803(LOC13, ((NI) 32));
		{
			nimln(91, "common.nim");
			while (1) {
				{
					NI i_278825;
					NI res_279235;
					i_278825 = 0;
					nimln(1598, "system.nim");
					res_279235 = ((NI) 1);
					{
						nimln(1599, "system.nim");
						while (1) {
							NU32 LOC19;
							NI TMP2729;
							if (!(res_279235 <= neededparts)) goto LA18;
							nimln(1600, "system.nim");
							i_278825 = res_279235;
							nimln(93, "common.nim");
							LOC19 = 0;
							LOC19 = randomuint32_275012(rng);
							result = (NU)((NU)((NU64)(result) << (NU64)(((NI) 32))) | ((NU) (LOC19)));
							nimln(1619, "system.nim");
							TMP2729 = addInt(res_279235, ((NI) 1));
							res_279235 = (NI)(TMP2729);
						} LA18: ;
					}
				}
				nimln(94, "common.nim");
				{
					if (!((NU64)(result) < (NU64)(limit))) goto LA22;
					goto LA14;
				}
				LA22: ;
			}
		} LA14: ;
	}
	LA1: ;
	nimln(99, "common.nim");
	result = (NU)((NU64)(result) % (NU64)(max));
	popFrame();
	return result;
}

N_NIMCALL(NU64, randomintimpl_279777)(Mtstate273035* rng) {
	NU64 result;
	NI neededparts;
	nimfr("randomIntImpl", "common.nim")
	result = 0;
	nimln(63, "common.nim");
	neededparts = ((NI) 2);
	{
		NI i_280213;
		NI res_280615;
		i_280213 = 0;
		nimln(1598, "system.nim");
		res_280615 = ((NI) 1);
		{
			nimln(1599, "system.nim");
			while (1) {
				NU32 LOC4;
				NI TMP2738;
				if (!(res_280615 <= neededparts)) goto LA3;
				nimln(1600, "system.nim");
				i_280213 = res_280615;
				nimln(65, "common.nim");
				nimln(66, "common.nim");
				LOC4 = 0;
				LOC4 = randomuint32_275012(rng);
				result = (NU64)((NU64)((NU64)(result) << (NU64)(32ULL)) | ((NU64) (LOC4)));
				nimln(1619, "system.nim");
				TMP2738 = addInt(res_280615, ((NI) 1));
				res_280615 = (NI)(TMP2738);
			} LA3: ;
		}
	}
	popFrame();
	return result;
}

static N_INLINE(NU64, randomint_279766)(Mtstate273035* rng) {
	NU64 result;
	nimfr("randomInt", "common.nim")
	result = 0;
	nimln(69, "common.nim");
	nimln(70, "common.nim");
	result = randomintimpl_279777(rng);
	popFrame();
	return result;
}

static N_INLINE(NI, chckRange)(NI i, NI a, NI b) {
	NI result;
{	result = 0;
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (a <= i);
		if (!(LOC3)) goto LA4;
		LOC3 = (i <= b);
		LA4: ;
		if (!LOC3) goto LA5;
		result = i;
		goto BeforeRet;
	}
	goto LA1;
	LA5: ;
	{
		raiseRangeError(((NI64) (i)));
	}
	LA1: ;
	}BeforeRet: ;
	return result;
}

N_NIMCALL(NF, randomprecise_279719)(Mtstate273035* rng) {
	NF result;
	NI exponent_279727;
	NU64 significand_279729;
	NI rshift_279731;
	nimfr("randomPrecise", "common.nim")
{	result = 0;
	nimln(77, "random_real.nim");
	exponent_279727 = ((NI) -64);
	significand_279729 = 0;
	rshift_279731 = 0;
	{
		nimln(83, "random_real.nim");
		while (1) {
			NIM_BOOL LOC3;
			NI TMP2739;
			significand_279729 = randomint_279766(rng);
			LOC3 = 0;
			LOC3 = unlikely((significand_279729 == ((NI) 0)));
			if (!LOC3) goto LA2;
			nimln(84, "random_real.nim");
			TMP2739 = subInt(exponent_279727, ((NI) 64));
			exponent_279727 = (NI)(TMP2739);
			nimln(91, "random_real.nim");
			{
				NIM_BOOL LOC6;
				LOC6 = 0;
				LOC6 = unlikely((exponent_279727 < ((NI) -1074)));
				if (!LOC6) goto LA7;
				nimln(92, "random_real.nim");
				result = 0.0;
				goto BeforeRet;
			}
			LA7: ;
		} LA2: ;
	}
	nimln(100, "random_real.nim");
	rshift_279731 = bitsize_270518(significand_279729);
	nimln(101, "random_real.nim");
	{
		NI TMP2740;
		NI TMP2741;
		NI TMP2742;
		NU64 LOC13;
		if (!!((rshift_279731 == ((NI) 64)))) goto LA11;
		nimln(102, "random_real.nim");
		TMP2740 = subInt(((NI) 64), rshift_279731);
		TMP2741 = subInt(exponent_279727, (NI)(TMP2740));
		exponent_279727 = (NI)(TMP2741);
		nimln(103, "random_real.nim");
		TMP2742 = subInt(((NI) 64), rshift_279731);
		significand_279729 = (NU64)((NU64)(significand_279729) << (NU64)(((NU64) ((NI)(TMP2742)))));
		nimln(104, "random_real.nim");
		nimln(138, "common.nim");
		LOC13 = 0;
		LOC13 = randomint_279766(rng);
		significand_279729 = (NU64)(significand_279729 | (NU64)((NU64)(LOC13) >> (NU64)(((NU64) (rshift_279731)))));
	}
	LA11: ;
	nimln(111, "random_real.nim");
	significand_279729 = (NU64)(significand_279729 | 1ULL);
	nimln(115, "random_real.nim");
	result = ldexp(((NF) (significand_279729)), ((int)chckRange(exponent_279727, ((int) (-2147483647 -1)), ((int) 2147483647))));
	goto BeforeRet;
	}BeforeRet: ;
	popFrame();
	return result;
}
NIM_EXTERNC N_NOINLINE(void, random_commonInit)(void) {
	nimfr("common", "common.nim")
	popFrame();
}

NIM_EXTERNC N_NOINLINE(void, random_commonDatInit)(void) {
}

